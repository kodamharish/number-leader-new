{% include 'admin/company_profile.html' %}

{% block styles %}
<style>
    :root {
        --row-height: 20px !important;
        --font-size: 14px;
        --first-column-width: 350px;
        --indentation: 20px;
        --double-indentation: 40px;
        --triple-indentation: 60px;
        --quad-indentation: 80px;
        --column-width: 60px !important;
    }

    body {
        
        font-size: var(--font-size);
        color: black;
        overflow: hidden;
    }

    .container {
        margin-left: 250px;
        max-width: 100%;
        position: relative;
        height: calc(100vh - 135px);
        overflow-y: auto;
        max-height: 100%;
        margin-top: 25px !important;
        font-family: 'Arial MT Rounded';
    }

    .content {
        margin: 40px auto;
        padding-top: 30px;
        padding-left: 200px;
    }

    .table-wrapper {
        position: relative;
        width: 70%;
        overflow-x: auto;
        flex:2;
        max-width: 70% !important;
        margin-right: -250px;
        overflow-y: auto; /* Add vertical scrollbar */
    scrollbar-width: none;  /* Hide scrollbar for Firefox */
    -ms-overflow-style: none; 
    }
    .table-wrapper::-webkit-scrollbar {
    display: none; /* Hide scrollbar for Chrome, Safari, WebKit */
}

    table {
        width: 75%;
        table-layout: fixed;
        border-collapse: collapse;
        font-family: 'Arial MT Rounded';
        font-size: var(--font-size);
        /* coloumn-width:var(--column-width) !important; */
        
    }

    th, td {
        vertical-align: middle;
        text-align: right; 
        padding: 12px;
        height: var(--row-height);
        font-size: var(--font-size);
        line-height: 1.2;
        overflow: hidden;
        transition: background-color 0.3s ease;
        border-bottom: 1px solid #ddd;
    }

    th {
       
        position: sticky;
        top: 0;
        z-index: 2;
        text-align: center !important;
    }

    td:first-child {
        position: sticky;
        left: 0;
        background-color: white;
        z-index: 3;
        width: 350px !important;
        text-align: left;
    }
    .td{
        text-align: right !important;
    }


    .table tbody tr:hover {
        background-color: #f0f0f0;
    }

    .indent-level-1 td:first-child {
        padding-left: var(--indentation) !important;
    }

    .indent-level-2 td:first-child {
        padding-left: var(--double-indentation) !important;
    }

    .indent-level-3 td:first-child {
        padding-left: var(--triple-indentation) !important;
    }

    .indent-level-4 td:first-child {
        padding-left: var(--quad-indentation) !important;
    }

    .expandable-icon {
        cursor: pointer;
        margin-left: 5px;
    }

    .expandable-icon::before {
        content: "\25B6";
        display: inline-block;
        transform: rotate(90deg);
    }

    .collapse.show .expandable-icon::before {
        content: "\25BC";
        transform: rotate(0deg);
    }

    .btn-plus {
        font-size: 24px;
        color: #007bff;
        text-decoration: none;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        padding-left: 20px;
        margin-top: -10px;
        font-weight: bold; 
    }

    .btn-plus:hover {
        color: #0056b3;
    }

    tr.hidden {
        display: none;
    }

    .table-container {
        max-height: 500px;
        overflow-y: auto;
        overflow-x: auto;
        scrollbar-width: none;  /* Firefox */
    -ms-overflow-style: none;  /* Internet Explorer and Edge */
}

.table-container::-webkit-scrollbar {
    display: none; /* Chrome, Safari, WebKit */
}

    /* Remove vertical lines inside the table */
    table, th, td {
        border-left: none;
        border-right: none;
    }

    .editable input {
        border: none;            /* Remove all borders */
        border-bottom: 1px solid #000; /* Add only bottom border */
        text-align: right;        /* Align text to the right */
        background: transparent;  /* Make background transparent */
        outline: none;            /* Remove focus outline */
        padding: 0;
        width: 100%;              /* Make input fields fill the cell */
        box-shadow: none !important; /* Remove any default box shadow */
        -webkit-box-shadow: none !important; /* For WebKit browsers */
        -moz-box-shadow: none !important; /* For Mozilla-based browsers */
        border-radius: 0px !important;
    }

    .editable input:focus {
        outline: none;            /* Remove focus outline */
        box-shadow: none !important; /* Remove any box shadow on focus */
        -webkit-box-shadow: none !important; /* For WebKit browsers */
        -moz-box-shadow: none !important; /* For Mozilla-based browsers */
    }
    .btn btn-primary,btn-success{
        margin-top: -10px;
    }
    .table-card-wrapper{
        display: flex;
        justify-content: block;

    }
    .card{
        flex:1;
        /* margin-left: 0px; */
        max-width: 30%;
        overflow-y: auto;
        scrollbar-width: none;  /* Hide scrollbar for Firefox */
        -ms-overflow-style: none; 
        max-height: 550px;
        border-left: 1px solid black;
        border-bottom: 0px;
        border-right: 0px;
        border-top: 0px;
        border-radius: 0px;
        

    }
    .card::-webkit-scrollbar {
    display: none; /* Hide scrollbar for Chrome, Safari, WebKit */
}
    .form-group{
    padding-left: 0px;
    margin-left: 0px;
}
.form-control{
    border-bottom: 1px black solid;
    border-top: 0px;
    border-left: 0px;
    border-right: 0px;
    border-radius: 0px;
}
.card-title{
    padding-bottom: 20px;
    text-align: center;
}
.liquidity{
    text-align: center;
    color:black;
}
.label{
    font-family: 'Arial MT Rounded';
    font-size: 12px;
    color: grey;
    text-decoration: none;
    
}
.lable-value{
    font-family: 'Arial MT Rounded';
    font-size: 16px;
    text-decoration: bold;
    margin-top: -8px;
}
.btn-group ms-3{
    margin-left: 100px !important;
}
</style>
{% endblock styles %}

{% block content %}
<div class="container mt-5">
    {% for msg in messages %}
    <p class="text-danger text-center mt-2 fw-bold" style="font-size: 1rem;">{{ msg }}</p>
    {% endfor %}
    <div class="row" style="align-items: center;">
        <div class="col-md-6 d-flex align-items-center">
            <h6 class="mb-6" style="color: black;" style="font-size: 16px;">
                Corporate Finance -
                {% if request.resolver_match.url_name == 'planning_budgeting_balance_sheet_table' %}
                Planning & Budgeting
                {% elif request.resolver_match.url_name == 'forecasting_balance_sheet_table' %}
                Forecasting
                {% endif %}
                - <b>Balance Sheet</b>
            </h6>
            <div class="btn-group ms-3" >
                <button class="btn btn-primary">Monthly</button>
                <button class="btn btn-primary">Quarterly</button>
                <button class="btn btn-primary">Annual</button>
            </div>
        </div>

       
        <div class="col-md-4 text-end d-flex justify-content-end align-items-center">
            
            <a href="#" class="btn-plus" data-bs-toggle="modal" data-bs-target="#balance_sheet">+</a>
            <button id="editButton" class="btn btn-primary">Edit</button>
            <button id="saveButton" class="btn btn-success  d-none">Save Changes</button>
            <!-- The Modal -->
            <div class="modal" id="balance_sheet">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <!-- Modal Header -->
                        <div class="modal-header">
                            <h4 class="modal-title"></h4>
                            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                        </div>
                        <!-- Modal body -->
                        <div class="modal-body text-center">
                            <form method="POST" action="#" enctype="multipart/form-data">
                                {% csrf_token %}
                                <div class="inline">
                                    <div style="margin-right:15px;">
                                        <input type="radio" class="form-check-input" id="monthly"
                                            name="select_type_of_data" value="monthly">
                                        <label class="form-check-label" for="monthly">Monthly</label>
                                    </div>
                                    <div style="margin-right:15px;">
                                        <input type="radio" class="form-check-input" id="quarterly"
                                            name="select_type_of_data" value="quarterly">
                                        <label class="form-check-label" for="quarterly">Quarterly</label>
                                    </div>
                                    <div>
                                        <input type="radio" class="form-check-input" id="yearly"
                                            name="select_type_of_data" value="yearly">
                                        <label class="form-check-label" for="yearly">Yearly</label>
                                    </div>
                                </div>
                                <div id="dropdown-container" class="mt-3"></div>
                                <button type="submit" class="btn btn-primary mt-3">Submit</button>
                            </form>
                        </div>
                        <!-- Modal footer -->
                        <div class="modal-footer">
                            <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Close</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="table-container mt-1">
        <div class="table-card-wrapper">
        <div class="table-wrapper">
            <table class="cell">
                <thead>
                    

                    <tr>
                        <th class="rowview">Breakdown</th>
                        {% for balance_sheet in balance_sheets %}
                        <th class="rowview1" data-end-date="{{ balance_sheet.end_date|date:'Y-m-d' }}">
                            {{ balance_sheet.end_date|date:'d-m-Y' }}
                            <span class="period-type" style="display: none;">{{ balance_sheet.monthly_or_quarterly_or_yearly }}</span>
                        </th>
                        {% endfor %}
                    </tr>
                    
                </thead>
                <tbody>
                    <!-- Total Assets Section -->
                    <tr>
                        <td>Total Assets <span class="expandable-icon" onclick="toggle(this, '#MS01a');"></span></td>
                        {% for balance_sheet in balance_sheets %}
                        <td id="total_assets-{{ forloop.counter }}"  data-field-name="total_assets">{{balance_sheet.total_assets}}</td>
                        {% endfor %}
                    </tr>
                    <tr id="MS01a" class="hidden indent-level-1">
                        <td>Current Assets <span class="expandable-icon" onclick="toggle(this, '#MS01b');"></span></td>
                        {% for balance_sheet in balance_sheets %}
                        <td class="current-assets-column"  data-field-name="current-assets" id="current-assets-{{ forloop.counter }}">{{ balance_sheet.current_assets }}</td>
                        {% endfor %}
                    </tr>
                    
                    <tr id="MS01b" class="hidden indent-level-2">
                        <td>Cash, Cash Equivalents & Short Term Investments <span class="expandable-icon"
                                onclick="toggle(this, '#MS01c');"></span></td>
                        {% for balance_sheet in balance_sheets %}
                        <td class="cash-cash-equivalents-and-short-term"  data-field-name="cash-cash-equivalents-and-short-term" id="cash-cash-equivalents-and-short-term-{{ forloop.counter }}">{{ balance_sheet.cash_cash_equivalents_and_short_term_investments }}</td>
                        {% endfor %}
                    </tr>
                    <tr id="MS01c" class="hidden indent-level-3">
                        <td>Cash And Cash Equivalents <span class="expandable-icon" onclick="toggle(this, '#MS01d');"></span></td>
                        {% for balance_sheet in balance_sheets %}
                        <td class="cash-cash-equivalents-column"  data-field-name="cash-and-cash-equivalents" id="cash-and-cash-equivalents-{{ forloop.counter }}">{{ balance_sheet.cash_and_cash_equivalents }}</td>
                        {% endfor %}
                    </tr>
                    <tr id="MS01d" class="hidden indent-level-4">
                        <td>Cash</td>
                        {% for balance_sheet in balance_sheets %}
                        <td class="editable cash-column"  data-field-name="cash" id="cash-{{ forloop.counter }}" oninput="calculatetotal()">{{ balance_sheet.cash }}</td>
                        {% endfor %}
                    </tr>
                    <tr id="MS01d" class="hidden indent-level-4">
                        <td>Cash Equivalents</td>
                        {% for balance_sheet in balance_sheets %}
                        <td class="editable cash-equivalents-column"  data-field-name="cash-equivalents" id="cash-equivalents-{{ forloop.counter }}" oninput="calculatetotal()">{{ balance_sheet.cash_equivalents }}</td>
                        {% endfor %}
                    </tr>
                    <tr id="MS01c" class="hidden indent-level-3">
                        <td>Other Short Term Investments</td>
                        {% for balance_sheet in balance_sheets %}
                        <td class="editable short-term-investments-column"  data-field-name="other-short-term-investments" id="other-short-term-investments-{{ forloop.counter }}" oninput="calculatetotal()">{{ balance_sheet.other_short_term_investments }}</td>
                        {% endfor %}
                    </tr>

                    <!-- Receivables -->
                   <!-- Receivables -->
                    <tr id="MS01b" class="hidden indent-level-2">
                        <td>Receivables <span class="expandable-icon" onclick="toggle(this, '#MS01e');"></span></td>
                        {% for balance_sheet in balance_sheets %}
                        <td class="receivables-column"  data-field-name="receivables" id="receivables-{{ forloop.counter }}" oninput="calculatetotal()">{{ balance_sheet.receivables }}</td>
                        {% endfor %}
                    </tr>
                    <tr id="MS01e" class="hidden indent-level-3">
                        <td>Accounts Receivable <span class="expandable-icon" onclick="toggle(this, '#MS01f');"></span></td>
                        {% for balance_sheet in balance_sheets %}
                        <td class="accounts-receivable-column"  data-field-name="accounts-receivable" id="accounts-receivable-{{ forloop.counter }}" oninput="calculatetotal()">{{ balance_sheet.accounts_receivable }}</td>
                        {% endfor %}
                    </tr>
                    <tr id="MS01f" class="hidden indent-level-4">
                        <td>Gross Accounts Receivable</td>
                        {% for balance_sheet in balance_sheets %}
                        <td class="editable gross-accounts-receivable-column"  data-field-name="gross-accounts-receivable" id="gross-accounts-receivable-{{ forloop.counter }}" oninput="calculatetotal()">{{ balance_sheet.gross_accounts_receivable }}</td>
                        {% endfor %}
                    </tr>
                    <tr id="MS01f" class="hidden indent-level-4">
                        <td>Allowance For Doubtful Accounts Receivable</td>
                        {% for balance_sheet in balance_sheets %}
                        <td class="editable allowance-doubtful-column"   data-field-name="allowance-for-doubtful-accounts-receivable"id="allowance-for-doubtful-accounts-receivable-{{ forloop.counter }}" oninput="calculatetotal()">{{ balance_sheet.allowance_for_doubtful_accounts_receivable }}</td>
                        {% endfor %}
                    </tr>
                    <tr id="MS01e" class="hidden indent-level-3">
                        <td>Other Receivables</td>
                        {% for balance_sheet in balance_sheets %}
                        <td class="editable other-receivables-column"  data-field-name="other-receivables" id="other-receivables-{{ forloop.counter }}" oninput="calculatetotal()">{{ balance_sheet.other_receivables }}</td>
                        {% endfor %}
                    </tr>


                    <!-- Inventory -->
                    <tr id="MS01b" class="hidden indent-level-2">
                        <td>Inventory <span class="expandable-icon" onclick="toggle(this, '#MS01g');"></span></td>
                        {% for balance_sheet in balance_sheets %}
                        <td class="inventory-column"  data-field-name="inventory" id="inventory-{{ forloop.counter }}" oninput="calculatetotal()">{{ balance_sheet.inventory }}</td>
                        {% endfor %}
                    </tr>
                    <tr id="MS01g" class="hidden indent-level-3">
                        <td>Raw Materials</td>
                        {% for balance_sheet in balance_sheets %}
                        <td class="editable raw-materials-column"  data-field-name="raw-materials" id="raw-materials-{{ forloop.counter }}" oninput="calculatetotal()">{{ balance_sheet.raw_materials }}</td>
                        {% endfor %}
                    </tr>
                    <tr id="MS01g" class="hidden indent-level-3">
                        <td>Work In Process</td>
                        {% for balance_sheet in balance_sheets %}
                        <td class="editable work-process-column"  data-field-name="work-process" id="work-process-{{ forloop.counter }}" oninput="calculatetotal()">{{ balance_sheet.work_in_process }}</td>
                        {% endfor %}
                    </tr>
                    <tr id="MS01g" class="hidden indent-level-3">
                        <td>Finished Goods</td>
                        {% for balance_sheet in balance_sheets %}
                        <td class="editable finished-goods-column"  data-field-name="finished-goods" id="finished-goods-{{ forloop.counter }}" oninput="calculatetotal()">{{ balance_sheet.finished_goods }}</td>
                        {% endfor %}
                    </tr>


                    <!-- Hedging Assets Current -->
                    <tr id="MS01b" class="hidden indent-level-2">
                        <td>Hedging Assets Current</td>
                        {% for balance_sheet in balance_sheets %}
                        <td class="editable hedging-assets-column"  data-field-name="hedging-assets" id="hedging-assets-{{ forloop.counter }}" oninput="calculatetotal()">{{ balance_sheet.hedging_current_assets }}</td>
                        {% endfor %}
                    </tr>
                    
                    <!-- Other Current Assets -->
                    <tr id="MS01b" class="hidden indent-level-2">
                        <td>Other Current Assets</td>
                        {% for balance_sheet in balance_sheets %}
                        <td class="editable other-current-assets-column"  data-field-name="other-current-assets" id="other-current-assets-{{ forloop.counter }}" oninput="calculatetotal()">{{ balance_sheet.other_current_assets }}</td>
                        {% endfor %}
                    </tr>


                    <tr>
                        <td>Total non-current assets <span class="expandable-icon" onclick="toggle(this, '#LI01');"></span></td>
                        {% for balance_sheet in balance_sheets %}
                        <td class=" total_non_current_assets_column"  data-field-name="total_non_current_assets" id="total_non_current_assets-{{ forloop.counter }}" oninput="calculatetotal()">{{ balance_sheet.total_non_current_assets }}</td>
                        {% endfor %}
                    </tr>

                    <tr id="LI01" class="hidden indent-level-1">
                        <td>Net PPE <span class="expandable-icon" onclick="toggle(this, '#LI011a');"></span></td>
                        {% for balance_sheet in balance_sheets %}
                        <td class=" net_ppe_column"  data-field-name="net_ppe" id="net_ppe-{{ forloop.counter }}" oninput="calculatetotal()">{{ balance_sheet.net_ppe }}</td>
                        {% endfor %}
                    </tr>
                    <tr id="LI011a" class="hidden indent-level-2">
                        <td>Gross PPE <span class="expandable-icon" onclick="toggle(this, '#LI011c');"></span></td>
                        {% for balance_sheet in balance_sheets %}
                        <td class="gross_ppe-column"  data-field-name="gross_ppe" id="gross_ppe-{{ forloop.counter }}">{{ balance_sheet.gross_ppe }}</td>
                        {% endfor %}
                    </tr>
                    <tr id="LI011c" class="hidden indent-level-3">
                        <td>Land And Improvements</td>
                        {% for balance_sheet in balance_sheets %}
                        <td class="editable land_and_improvements-column"  data-field-name="land_and_improvements" id="land_and_improvements-{{ forloop.counter }}" oninput="calculatetotal()">{{ balance_sheet.land_and_improvements }}</td>
                        {% endfor %}
                    </tr>
                    <tr id="LI011c" class="hidden indent-level-3">
                        <td>Buildings And Improvements</td>
                        {% for balance_sheet in balance_sheets %}
                        <td class="editable buildings_and_improvements-column"  data-field-name="buildings_and_improvements" id="buildings_and_improvements-{{ forloop.counter }}" oninput="calculatetotal()">{{ balance_sheet.buildings_and_improvements }}</td>
                        {% endfor %}
                    </tr>
                    <tr id="LI011c" class="hidden indent-level-3">
                        <td>Machinery Furniture Equipment</td>
                        {% for balance_sheet in balance_sheets %}
                        <td class="editable machinery_furniture_equipment-column"  data-field-name="machinery_furniture_equipment" id="machinery_furniture_equipment-{{ forloop.counter }}" oninput="calculatetotal()">{{ balance_sheet.machinery_furniture_equipment }}</td>
                        {% endfor %}
                    </tr>
                    <tr id="LI011c" class="hidden indent-level-3">
                        <td>Other Properties</td>
                        {% for balance_sheet in balance_sheets %}
                        <td class="editable other_properties-column"  data-field-name="other_properties" id="other_properties-{{ forloop.counter }}" oninput="calculatetotal()">{{ balance_sheet.other_properties }}</td>
                        {% endfor %}
                    </tr>
                    <tr id="LI011c" class="hidden indent-level-3">
                        <td>Leases</td>
                        {% for balance_sheet in balance_sheets %}
                        <td class="editable leases-column"  data-field-name="leases" id="leases-{{ forloop.counter }}" oninput="calculatetotal()">{{ balance_sheet.leases }}</td>
                        {% endfor %}
                    </tr>
                    <tr id="LI011a" class="hidden indent-level-2">
                        <td>Accumulated Depreciation <span></span></td>
                        {% for balance_sheet in balance_sheets %}
                        <td class="editable accumulated_depreciation-column"  data-field-name="accumulated_depreciation" id="accumulated_depreciation-{{ forloop.counter }}" oninput="calculatetotal()">{{ balance_sheet.accumulated_depreciation }}</td>
                        {% endfor %}
                    </tr>

                    <tr id="LI01" class="hidden indent-level-1">
                        <td>Goodwill And Other Intangible Assets <span class="expandable-icon" onclick="toggle(this, '#LI011d');"></span></td>
                        {% for balance_sheet in balance_sheets %}
                        <td class=" goodwill_and_other_intangible_assets_column"  data-field-name="goodwill_and_other_intangible_assets" id="goodwill_and_other_intangible_assets-{{ forloop.counter }}" oninput="calculatetotal()">{{ balance_sheet.goodwill_and_other_intangible_assets }}</td>
                        {% endfor %}
                    </tr>
                    <tr id="LI011d" class="hidden indent-level-2">
                        <td>Goodwill <span></span></td>
                        {% for balance_sheet in balance_sheets %}
                        <td class="editable goodwill-column"  data-field-name="goodwill" id="goodwill-{{ forloop.counter }}" oninput="calculatetotal()">{{ balance_sheet.goodwill }}</td>
                        {% endfor %}
                    </tr>
                    <tr id="LI011d" class="hidden indent-level-2">
                        <td>Other Intangible Assets <span></span></td>
                        {% for balance_sheet in balance_sheets %}
                        <td class="editable other-intangible-assets-column"  data-field-name="other_intangible_assets" id="other_intangible_assets-{{ forloop.counter }}" oninput="calculatetotal()">{{ balance_sheet.other_intangible_assets }}</td>
                        {% endfor %}
                    </tr>
                    <tr id="LI01" class="hidden indent-level-1">
                        <td>Investments And Advances <span class="expandable-icon" onclick="toggle(this, '#LI011e');"></span></td>
                        {% for balance_sheet in balance_sheets %}
                        <td class=" investments_and_advances_column"  data-field-name="investments_and_advances" id="investments_and_advances-{{ forloop.counter }}" oninput="calculatetotal()">{{ balance_sheet.investments_and_advances }}</td>
                        {% endfor %}
                    </tr>
                    <tr id="LI011e" class="hidden indent-level-2">
                        <td>Long Term Equity Investment <span></span></td>
                        {% for balance_sheet in balance_sheets %}
                        <td class="editable long-term-equity-investment-column"  data-field-name="long_term_equity_investment" id="long_term_equity_investment-{{ forloop.counter }}" oninput="calculatetotal()">{{ balance_sheet.long_term_equity_investment }}</td>
                        {% endfor %}
                    </tr>
                    <tr id="LI01" class="hidden indent-level-1">
                        <td>Other Non Current Assets <span></span></td>
                        {% for balance_sheet in balance_sheets %}
                        <td class="editable other_non_current_assets_column"  data-field-name="other_non_current_assets" id="other_non_current_assets-{{ forloop.counter }}" oninput="calculatetotal()">{{ balance_sheet.other_non_current_assets }}</td>
                        {% endfor %}
                    </tr>

                    <!-- Total Liabilities Net Minority Interest -->
                    <tr>
                        <td>Total Liabilities Net Minority Interest <span class="expandable-icon" onclick="toggle(this, '#LI01a');"></span></td>
                        {% for balance_sheet in balance_sheets %}
                        <td class=" total-liabilities-column"  data-field-name="total-liabilities-net-minority-interest" id="total-liabilities-net-minority-interest-{{ forloop.counter }}" oninput="calculatetotal()">{{ balance_sheet.total_liabilities_net_minority_interest }}</td>
                        {% endfor %}
                    </tr>
                    <tr id="LI01a" class="hidden indent-level-1">
                        <td>Current Liabilities <span class="expandable-icon" onclick="toggle(this, '#LI01b');"></span></td>
                        {% for balance_sheet in balance_sheets %}
                        <td class=" current-liabilities-column"  data-field-name="current-liabilities" id="current-liabilities-{{ forloop.counter }}" oninput="calculatetotal()">{{ balance_sheet.current_liabilities }}</td>
                        {% endfor %}
                    </tr>
                    <tr id="LI01b" class="hidden indent-level-2">
                        <td>Payables And Accrued Expenses <span class="expandable-icon" onclick="toggle(this, '#LI01c');"></span></td>
                        {% for balance_sheet in balance_sheets %}
                        <td class=" payables-accrued-column"  data-field-name="payables-and-accrued-expenses" id="payables-and-accrued-expenses-{{ forloop.counter }}" oninput="calculatetotal()">{{ balance_sheet.payables_and_accrued_expenses }}</td>
                        {% endfor %}
                    </tr>
                    <tr id="LI01c" class="hidden indent-level-3">
                        <td>Accounts Payable</td>
                        {% for balance_sheet in balance_sheets %}
                        <td class="editable accounts-payable-column"  data-field-name="accounts-payable" id="accounts-payable-{{ forloop.counter }}" oninput="calculatetotal()">{{ balance_sheet.accounts_payable }}</td>
                        {% endfor %}
                    </tr>
                    <tr id="LI01c" class="hidden indent-level-3">
                        <td>Income Tax Payable</td>
                        {% for balance_sheet in balance_sheets %}
                        <td class="editable income-tax-payable-column"  data-field-name="income-tax-payable" id="income-tax-payable-{{ forloop.counter }}" oninput="calculatetotal()">{{ balance_sheet.income_tax_payable }}</td>
                        {% endfor %}
                    </tr>
                    

                    <!-- Pension & Other Post Retirement Benefit Plans Current -->
                    <tr id="LI01b" class="hidden indent-level-2">
                        <td>Pension & Other Post Retirement Benefit Plans Current</td>
                        {% for balance_sheet in balance_sheets %}
                        <td class="editable pension-post-retirement-column"  data-field-name="pension-post-retirement" id="pension-post-retirement-{{ forloop.counter }}" oninput="calculatetotal()">{{ balance_sheet.pension_other_post_retirement_plans_current }}</td>
                        {% endfor %}
                    </tr>
                    <!-- Current Debt And Capital Lease Obligation -->
                    <tr id="LI01b" class="hidden indent-level-2">
                        <td>Current Debt And Capital Lease Obligation <span class="expandable-icon" onclick="toggle(this, '#LI01d');"></span></td>
                        {% for balance_sheet in balance_sheets %}
                        <td class="current-debt-and-capital-lease-obligation-column"  data-field-name="current-debt-and-capital-lease-obligation" id="current-debt-and-capital-lease-obligation-{{ forloop.counter }}" oninput="calculatetotal()">{{ balance_sheet.current_debt_and_capital_lease_obligation }}</td>
                        {% endfor %}
                    </tr>
                    <tr id="LI01d" class="hidden indent-level-3">
                        <td>Current Debt</td>
                        {% for balance_sheet in balance_sheets %}
                        <td class="editable current-debt-column"  data-field-name="current-debt" id="current-debt-{{ forloop.counter }}" oninput="calculatetotal()">{{ balance_sheet.current_debt }}</td>
                        {% endfor %}
                    </tr>
                    <tr id="LI01d" class="hidden indent-level-3">
                        <td>Capital Lease Obligation</td>
                        {% for balance_sheet in balance_sheets %}
                        <td class="editable capital-lease-column"  data-field-name="capital-lease" id="capital-lease-{{ forloop.counter }}" oninput="calculatetotal()">{{ balance_sheet.capital_lease_obligation }}</td>
                        {% endfor %}
                    </tr>

                    <!-- Current Deferred Liabilities -->
                    <tr id="LI01b" class="hidden indent-level-2">
                        <td>Current Deferred Liabilities <span class="expandable-icon" onclick="toggle(this, '#LI01e');"></span></td>
                        {% for balance_sheet in balance_sheets %}
                        <td class=" deferred-liabilities-column"  data-field-name="current-deferred-liabilities" id="current-deferred-liabilities-{{ forloop.counter }}" oninput="calculatetotal()">{{ balance_sheet.current_deferred_liabilities }}</td>
                        {% endfor %}
                    </tr>
                    <tr id="LI01e" class="hidden indent-level-3">
                        <td>Current Deferred Revenue</td>
                        {% for balance_sheet in balance_sheets %}
                        <td class="editable deferred-revenue-column"  data-field-name="current-deferred-revenue" id="current-deferred-revenue-{{ forloop.counter }}" oninput="calculatetotal()">{{ balance_sheet.current_deferred_revenue }}</td>
                        {% endfor %}
                    </tr>

                    <!-- Other Current Liabilities -->
                    <tr id="LI01b" class="hidden indent-level-2">
                        <td>Other Current Liabilities</td>
                        {% for balance_sheet in balance_sheets %}
                        <td class="editable other-current-liabilities-column"  data-field-name="other-current-liabilities" id="other-current-liabilities-{{ forloop.counter }}" oninput="calculatetotal()">{{ balance_sheet.other_current_liabilities }}</td>
                        {% endfor %}
                    </tr>

                    <!-- Total Non-Current Liabilities Net Minority Interest -->
                    <tr id="LI01a" class="hidden indent-level-1">
                        <td>Total Non-Current Liabilities Net Minority Interest <span class="expandable-icon" onclick="toggle(this, '#LI02a');"></span></td>
                        {% for balance_sheet in balance_sheets %}
                        <td class="total-non-current-liabilities-column"  data-field-name="total-non-current-liabilities-net-minority-interest" id="total-non-current-liabilities-net-minority-interest-{{ forloop.counter }}" oninput="calculatetotal()">{{ balance_sheet.total_non_current_liabilities_net_minority_interest }}</td>
                        {% endfor %}
                    </tr>
                    <tr id="LI02a" class="hidden indent-level-2">
                        <td>Long Term Debt And Capital Lease Obligation <span class="expandable-icon" onclick="toggle(this, '#LI02b');"></span></td>
                        {% for balance_sheet in balance_sheets %}
                        <td class=" long-term-debt-and-capital-lease-obligation"  data-field-name="long-term-debt-and-capital-lease-obligation"  id="long-term-debt-and-capital-lease-obligation-{{ forloop.counter }}" oninput="calculatetotal()">{{ balance_sheet.long_term_debt_and_capital_lease_obligation }}</td>
                        {% endfor %}
                    </tr>
                    <tr id="LI02b" class="hidden indent-level-3">
                        <td>Long Term Debt</td>
                        {% for balance_sheet in balance_sheets %}
                        <td class="editable long-term-debt-column"  data-field-name="long-term-debt" id="long-term-debt-{{ forloop.counter }}" oninput="calculatetotal()">{{ balance_sheet.long_term_debt }}</td>
                        {% endfor %}
                    </tr>
                    <tr id="LI02b" class="hidden indent-level-3">
                        <td>Long Term Capital Lease Obligation</td>
                        {% for balance_sheet in balance_sheets %}
                        <td class="editable long-term-capital-lease-column"  data-field-name="long-term-capital-lease-obligation" id="long-term-capital-lease-obligation-{{ forloop.counter }}" oninput="calculatetotal()">{{ balance_sheet.long_term_capital_lease_obligation }}</td>
                        {% endfor %}
                    </tr>

                    <!-- Non-Current Deferred Liabilities -->
                    <tr id="LI02a" class="hidden indent-level-2">
                        <td>Non-Current Deferred Liabilities <span class="expandable-icon" onclick="toggle(this, '#LI02c');"></span></td>
                        {% for balance_sheet in balance_sheets %}
                        <td class=" non-current-deferred-liabilities-column"  data-field-name="non-current-deferred-liabilities" id="non-current-deferred-liabilities-{{ forloop.counter }}" oninput="calculatetotal()">{{ balance_sheet.non_current_deferred_liabilities }}</td>
                        {% endfor %}
                    </tr>
                    <tr id="LI02c" class="hidden indent-level-3">
                        <td>Non-Current Deferred Taxes Liabilities</td>
                        {% for balance_sheet in balance_sheets %}
                        <td class="editable non-current-deferred-taxes-column"  data-field-name="non-current-deferred-taxes-liabilities" id="non-current-deferred-taxes-liabilities-{{ forloop.counter }}" oninput="calculatetotal()">{{ balance_sheet.non_current_deferred_taxes_liabilities }}</td>
                        {% endfor %}
                    </tr>
                    <tr id="LI02c" class="hidden indent-level-3">
                        <td>Non-Current Deferred Revenue</td>
                        {% for balance_sheet in balance_sheets %}
                        <td class="editable non-current-deferred-revenue-column"  data-field-name="non-current-deferred-revenue" id="non-current-deferred-revenue-{{ forloop.counter }}" oninput="calculatetotal()">{{ balance_sheet.non_current_deferred_revenue }}</td>
                        {% endfor %}
                    </tr>

                    <!-- Trade and Other Payables Non-Current -->
                    <tr id="LI02a" class="hidden indent-level-2">
                        <td>Trade and Other Payables Non-Current</td>
                        {% for balance_sheet in balance_sheets %}
                        <td class="editable trade-other-payables-column"  data-field-name="trade-and-other-payables-non-current" id="trade-and-other-payables-non-current-{{ forloop.counter }}" oninput="calculatetotal()">{{ balance_sheet.trade_and_other_payables_non_current }}</td>
                        {% endfor %}
                    </tr>

                    <!-- Other Non-Current Liabilities -->
                    <tr id="LI02a" class="hidden indent-level-2">
                        <td>Other Non-Current Liabilities</td>
                        {% for balance_sheet in balance_sheets %}
                        <td class="editable other-non-current-liabilities-column"  data-field-name="other-non-current-liabilities" id="other-non-current-liabilities-{{ forloop.counter }}" oninput="calculatetotal()">{{ balance_sheet.other_non_current_liabilities }}</td>
                        {% endfor %}
                    </tr>

                    <!-- Total Equity Gross Minority Interest -->
                    <tr>
                        <td>Total Equity Gross Minority Interest <span class="expandable-icon" onclick="toggle(this, '#EQ01a');"></span></td>
                        {% for balance_sheet in balance_sheets %}
                        <td class=" total-equity-column"  data-field-name="total-equity-gross-minority-interest" id="total-equity-gross-minority-interest-{{ forloop.counter }}" oninput="calculatetotal()">{{ balance_sheet.total_equity_gross_minority_interest }}</td>
                        {% endfor %}
                    </tr>
                    <tr id="EQ01a" class="hidden indent-level-1">
                        <td>Stockholders' Equity <span class="expandable-icon" onclick="toggle(this, '#EQ01b');"></span></td>
                        {% for balance_sheet in balance_sheets %}
                        <td class=" stockholders-equity-column"  data-field-name="stockholders-equity" id="stockholders-equity-{{ forloop.counter }}" oninput="calculatetotal()">{{ balance_sheet.stockholders_equity }}</td>
                        {% endfor %}
                    </tr>
                    <tr id="EQ01b" class="hidden indent-level-2">
                        <td>Capital Stock <span class="expandable-icon" onclick="toggle(this, '#EQ01c');"></span></td>
                        {% for balance_sheet in balance_sheets %}
                        <td class="capital-stock-column"  data-field-name="capital-stock" id="capital-stock-{{ forloop.counter }}" oninput="calculatetotal()">{{ balance_sheet.capital_stock }}</td>
                        {% endfor %}
                    </tr>
                    <tr id="EQ01c" class="hidden indent-level-3">
                        <td>Common Stock</td>
                        {% for balance_sheet in balance_sheets %}
                        <td class="editable common-stock-column"  data-field-name="common-stock" id="common-stock-{{ forloop.counter }}" oninput="calculatetotal()">{{ balance_sheet.common_stock }}</td>
                        {% endfor %}
                    </tr>

                    <!-- Retained Earnings -->
                    <tr id="EQ01b" class="hidden indent-level-2">
                        <td>Retained Earnings <span class="expandable-icon" onclick="toggle(this, '#EQ01d');"></span></td>
                        {% for balance_sheet in balance_sheets %}
                        <td class="retained-earnings-column"  data-field-name="retained-earnings" id="retained-earnings-{{ forloop.counter }}" oninput="calculatetotal()">{{ balance_sheet.retained_earnings }}</td>
                        {% endfor %}
                    </tr>
                    <tr id="EQ01d" class="hidden indent-level-3">
                        <td>Gains/(Losses) Not Affecting Retained Earnings</td>
                        {% for balance_sheet in balance_sheets %}
                        <td class="editable gains-losses-column" data-field-name="gains_losses_not_affecting_retained_earnings" id="gains-losses-not-affecting-retained-earnings-{{ forloop.counter }}" oninput="calculatetotal()">{{ balance_sheet.gains_or_losses_not_affecting_retained_earnings }}</td>
                        {% endfor %}
                    </tr>
                    <tr id="EQ01d" class="hidden indent-level-3">
                        <td>Other Equity Adjustments</td>
                        {% for balance_sheet in balance_sheets %}
                        <td class="editable other-equity-adjustments-column"  data-field-name="other-equity-adjustments" id="other-equity-adjustments-{{ forloop.counter }}" oninput="calculatetotal()">{{ balance_sheet.other_equity_adjustments }}</td>
                        {% endfor %}
                    </tr>
                </tbody>
            </table>
        </div>
        <div class="card">
            <div class="card-body">
                <h5 class="card-title">Ratios</h5>
                <div class="form-group" style="position: relative; margin-bottom: 20px;">
                    <label for="period" style="position: absolute; top: -20px; left: 0;">Select Period</label>
                    <select id="period" class="form-control">
                        <option value="" disabled selected>Choose Period</option>
                        {% for balance_sheet in balance_sheets %}
                            <option value="{{ balance_sheet.id }}">{{ balance_sheet.end_date|date:'d-m-Y' }}</option>
                        {% endfor %}
                    </select>
                </div>
        
                <h6 class="liquidity">Liquidity Ratios</h6>
                <div class="info-block">
                    <label for="current_ratio" class="label">Current Ratio</label>
                    <p id="current_ratio" class="lable-value"></p>
                </div>
                <div class="info-block">
                    <label for="quick_ratio" class="label">Quick Ratio</label>
                    <p id="quick_ratio" class="lable-value"></p>
                </div>
                <div class="info-block">
                    <label for="cash_ratio" class="label">Cash Ratio</label>
                    <p id="cash_ratio" class="lable-value"></p>
                </div>
                <div class="info-block">
                    <label for="working_capital" class="label">Working Capital</label>
                    <p id="working_capital" class="lable-value"></p>
                </div>
        
                <h6 class="liquidity">Solvency Ratios</h6>
                <div class="info-block">
                    <label for="debt_equity_ratio" class="label">Debt to Equity Ratio</label>
                    <p id="debt_equity_ratio" class="lable-value"></p>
                </div>
                <div class="info-block">
                    <label for="debt_ratio" class="label">Debt Ratio</label>
                    <p id="debt_ratio" class="lable-value"></p>
                </div>
                <div class="info-block">
                    <label for="equity_ratio" class="label">Equity Ratio</label>
                    <p id="equity_ratio" class="lable-value"></p>
                </div>
                <div class="info-block">
                    <label for="debt_capital_ratio" class="label">Debt to Capital Ratio</label>
                    <p id="debt_capital_ratio" class="lable-value"></p>
                </div>
        
                <h6 class="liquidity">Activity/ Efficiency Ratios</h6>
                <div class="info-block">
                    <label for="operating_cash_flow_ratio" class="label">Operating Cash Flow Ratio</label>
                    <p id="operating_cash_flow_ratio" class="lable-value"></p>
                </div>
                <div class="info-block">
                    <label for="debt_service_coverage_ratio" class="label">Debt Service Coverage Ratio</label>
                    <p id="debt_service_coverage_ratio" class="lable-value"></p>
                </div>
            </div>
        </div>
        
</div>
</div>

<script>
    function toggle(button, targetId) {
        var targetRows = document.querySelectorAll(targetId);
        var isExpanded = button.getAttribute('aria-expanded') === 'true';

        button.setAttribute('aria-expanded', !isExpanded);
        targetRows.forEach(row => {
            if (isExpanded) {
                row.classList.add('hidden');
            } else {
                row.classList.remove('hidden');
            }
        });
    }

    // Collapse all by default when the page is loaded
    window.onload = function() {
        document.querySelectorAll('.expandable-icon').forEach(icon => {
            icon.setAttribute('aria-expanded', 'false');
            var targetId = icon.getAttribute('onclick').split("'")[1];
            document.querySelectorAll(targetId).forEach(row => row.classList.add('hidden'));
        });
    }
     // Embed the Python-generated JSON data into JavaScript variables
     const months = JSON.parse('{{ months_json|escapejs }}');
    const quarters = JSON.parse('{{ quarters_json|escapejs }}');
    const years = JSON.parse('{{ years_json|escapejs }}');

    // JavaScript to handle dropdown options based on selected radio button
    const radioButtons = document.querySelectorAll('input[name="select_type_of_data"]');
    const dropdownContainer = document.getElementById('dropdown-container');

    radioButtons.forEach(radio => {
        radio.addEventListener('change', function () {
            dropdownContainer.innerHTML = ''; // Clear the container

            if (this.value === 'yearly') {
                // Create Year Dropdown
                const yearWrapper = document.createElement('div');
                yearWrapper.classList.add('inline-container');

                const yearLabel = document.createElement('label');
                yearLabel.setAttribute('for', 'year-select');
                yearLabel.textContent = 'Select Year:';

                const yearSelect = document.createElement('select');
                yearSelect.name = 'year';
                yearSelect.id = 'year-select';
                yearSelect.classList.add('form-select');
                createOptions(years, yearSelect);

                yearWrapper.appendChild(yearLabel); // Add the year label to the wrapper
                yearWrapper.appendChild(yearSelect); // Add the year dropdown to the wrapper
                dropdownContainer.appendChild(yearWrapper); // Add the year wrapper to the container

            } else {
                // Create Year Dropdown
                const yearWrapper = document.createElement('div');
                yearWrapper.classList.add('inline-container');

                const yearLabel = document.createElement('label');
                yearLabel.setAttribute('for', 'year-select');
                yearLabel.textContent = 'Select Year:';

                const yearSelect = document.createElement('select');
                yearSelect.name = 'year';
                yearSelect.id = 'year-select';
                yearSelect.classList.add('form-select');
                createOptions(years, yearSelect);

                yearWrapper.appendChild(yearLabel); // Add the year label to the wrapper
                yearWrapper.appendChild(yearSelect); // Add the year dropdown to the wrapper
                dropdownContainer.appendChild(yearWrapper); // Add the year wrapper to the container

                // Create Month/Quarter Dropdown
                const mainWrapper = document.createElement('div');
                mainWrapper.classList.add('inline-container');

                const mainLabel = document.createElement('label');
                mainLabel.setAttribute('for', 'main-select');

                const mainSelect = document.createElement('select');

                mainSelect.id = 'main-select';
                mainSelect.classList.add('form-select');

                if (this.value === 'monthly') {
                    mainLabel.textContent = 'Select Month:';
                    mainSelect.name = 'month';
                    createOptions(months, mainSelect);
                } else if (this.value === 'quarterly') {
                    // Convert quarters object to an array of strings in the format "Q1 Jan,Feb,Mar"
                    const quartersArray = Object.entries(quarters).map(([key, value]) => `${key} ${value}`);
                    mainLabel.textContent = 'Select Quarter:';
                    mainSelect.name = 'quarter';

                    createOptions(quartersArray, mainSelect);
                }

                mainWrapper.appendChild(mainLabel); // Add the main label to the wrapper
                mainWrapper.appendChild(mainSelect); // Add the main dropdown to the wrapper
                dropdownContainer.appendChild(mainWrapper); // Add the main wrapper to the container
            }
        });
    });

    function createOptions(options, selectElement) {
        options.forEach(option => {
            const opt = document.createElement('option');
            opt.value = option;
            opt.textContent = option;
            selectElement.appendChild(opt);
        });
    }

    document.getElementById('editButton').addEventListener('click', function () {
    // Show the Save button and hide the Edit button
    document.getElementById('editButton').classList.add('d-none');
    document.getElementById('saveButton').classList.remove('d-none');

    // Enable editing for all editable fields
    document.querySelectorAll('.editable').forEach((cell) => {
        const currentValue = cell.innerText.trim();
        cell.innerHTML = `<input type="text" class="form-control" value="${currentValue}" />`;
    });
});



document.getElementById('saveButton').addEventListener('click', function () {
    const editedData = [];
    const table = document.querySelector('table');

    // Get all editable table cells
    const editableCells = table.querySelectorAll('.editable');

    // Loop through each editable cell to get its updated value
    editableCells.forEach((cell) => {
        const input = cell.querySelector('input');
        const fieldName = cell.dataset.fieldName;  // Get the field name from the data attribute
        const newValue = input ? input.value.trim() : '';  // Get the input value

        if (fieldName && newValue !== '') {
            // Push the edited field and its new value into the editedData array
            editedData.push({
                fieldName: fieldName,
                newValue: newValue
            });
        }
    });

    console.log("Edited Data:", editedData);  // Log the edited data to see if it is collected

    // Prepare the POST request data
    const postData = {
        editedData: editedData,  // The collected edited data
        endDate: '2024-01-31'  // Replace this with the dynamic value
    };

    // Send the POST request to the backend
    fetch("/save-edited-data/C001/", {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
            'X-CSRFToken': '{{ csrf_token }}'
        },
        body: JSON.stringify(postData)
    })
    .then(response => response.json())
    .then(data => {
        console.log('Success:', data);
        alert('Data saved successfully!');
    })
    .catch((error) => {
        console.error('Error:', error);
        alert('Failed to save data.');
    });
});






    document.getElementById('period').addEventListener('change', function() {
        const selectedPeriodId = this.value;

        // Parse the serialized JSON from Django context
        const balancesheetRatios = JSON.parse('{{ balancesheetratios_json|escapejs }}');
        console.log(balancesheetRatios)

        // Find the ratios for the selected period
        const selectedRatios = balancesheetRatios.find(function(ratio) {
            return ratio.balancesheet_id === parseInt(selectedPeriodId);
        });

        // Update the HTML elements with the corresponding values
        if (selectedRatios) {
            document.getElementById('current_ratio').textContent = selectedRatios.current_ratio || 'N/A';
            document.getElementById('quick_ratio').textContent = selectedRatios.quick_ratio || 'N/A';
            document.getElementById('cash_ratio').textContent = selectedRatios.cash_ratio || 'N/A';
            document.getElementById('working_capital').textContent = selectedRatios.working_capital || 'N/A';
            document.getElementById('debt_equity_ratio').textContent = selectedRatios.debt_equity_ratio || 'N/A';
            document.getElementById('debt_ratio').textContent = selectedRatios.debt_ratio || 'N/A';
            document.getElementById('equity_ratio').textContent = selectedRatios.equity_ratio || 'N/A';
            document.getElementById('debt_capital_ratio').textContent = selectedRatios.debt_capital_ratio || 'N/A';
            document.getElementById('operating_cash_flow_ratio').textContent = selectedRatios.operating_cash_flow_ratio || 'N/A';
            document.getElementById('debt_service_coverage_ratio').textContent = selectedRatios.debt_service_coverage_ratio || 'N/A';
        } else {
            // Handle case where no matching ratios are found
            document.getElementById('current_ratio').textContent = 'N/A';
            document.getElementById('quick_ratio').textContent = 'N/A';
            document.getElementById('cash_ratio').textContent = 'N/A';
            document.getElementById('working_capital').textContent = 'N/A';
            document.getElementById('debt_equity_ratio').textContent = 'N/A';
            document.getElementById('debt_ratio').textContent = 'N/A';
            document.getElementById('equity_ratio').textContent = 'N/A';
            document.getElementById('debt_capital_ratio').textContent = 'N/A';
            document.getElementById('operating_cash_flow_ratio').textContent = 'N/A';
            document.getElementById('debt_service_coverage_ratio').textContent = 'N/A';
        }
    });



    function calculatetotal() {
    // Calculate Cash + Cash Equivalents + Short Term Investments
    const cashColumns = document.querySelectorAll('.cash-column');
    const cashEquivalentsColumns = document.querySelectorAll('.cash-equivalents-column');
    const shortTermInvestmentsColumns = document.querySelectorAll('.short-term-investments-column');

    cashColumns.forEach((cashCell, index) => {
        const cash = parseFloat(cashCell.querySelector('input')?.value || cashCell.innerText.trim()) || 0;
        const cashEquivalents = parseFloat(cashEquivalentsColumns[index].querySelector('input')?.value || cashEquivalentsColumns[index].innerText.trim()) || 0;
        const shortTermInvestments = parseFloat(shortTermInvestmentsColumns[index].querySelector('input')?.value || shortTermInvestmentsColumns[index].innerText.trim()) || 0;

        const cashTotal = cash + cashEquivalents;
        const cashAndShortTermTotal = cashTotal + shortTermInvestments;

        // Update totals in the corresponding fields
        document.getElementById(`cash-and-cash-equivalents-${index + 1}`).innerText = cashTotal;
        document.getElementById(`cash-cash-equivalents-and-short-term-${index + 1}`).innerText = cashAndShortTermTotal;
    });

const accountsReceivableColumns = document.querySelectorAll('.accounts-receivable-column');
const otherReceivablesColumns = document.querySelectorAll('.other-receivables-column');

accountsReceivableColumns.forEach((accountsReceivableCell, index) => {
    const accountsReceivable = parseFloat(accountsReceivableCell.querySelector('input')?.value.trim() || accountsReceivableCell.innerText.trim()) || 0;
    const otherReceivables = parseFloat(otherReceivablesColumns[index].querySelector('input')?.value.trim() || otherReceivablesColumns[index].innerText.trim()) || 0;

    const totalReceivables = accountsReceivable + otherReceivables;

    // Update totals in the corresponding fields
    //document.getElementById(`receivables-${index + 1}`).innerText = totalReceivables.toFixed(2); // Using toFixed(2) to format the number to 2 decimal places
    document.getElementById(`receivables-${index + 1}`).innerText = 
    Number.isInteger(totalReceivables) ? totalReceivables : totalReceivables.toFixed(2);

});

const grossAccountsReceivableColumns = document.querySelectorAll('.gross-accounts-receivable-column');
const allowanceDoubtfulColumns = document.querySelectorAll('.allowance-doubtful-column');

grossAccountsReceivableColumns.forEach((grossAccountsReceivableCell, index) => {
    const grossAccountsReceivable = parseFloat(grossAccountsReceivableCell.querySelector('input')?.value.trim() || grossAccountsReceivableCell.innerText.trim()) || 0;
    const allowanceDoubtful = parseFloat(allowanceDoubtfulColumns[index].querySelector('input')?.value.trim() || allowanceDoubtfulColumns[index].innerText.trim()) || 0;

    const totalAccountsReceivable = grossAccountsReceivable - allowanceDoubtful;

    // Update totals in the corresponding fields
    //document.getElementById(`accounts-receivable-${index + 1}`).innerText = totalAccountsReceivable.toFixed(2); // Using toFixed(2) to format the number to 2 decimal places
    document.getElementById(`accounts-receivable-${index + 1}`).innerText = 
    Number.isInteger(totalAccountsReceivable) ? totalAccountsReceivable : totalAccountsReceivable.toFixed(2);

});



    
    const rawMaterialsColumns = document.querySelectorAll('.raw-materials-column');
    const workProcessColumns = document.querySelectorAll('.work-process-column');
    const finishedGoodsColumns = document.querySelectorAll('.finished-goods-column');

    rawMaterialsColumns.forEach((rawMaterialsCell, index) => {
        // Retrieve values for Raw Materials, Work in Process, and Finished Goods
        const rawMaterialsValue = parseFloat(rawMaterialsCell.querySelector('input')?.value || rawMaterialsCell.innerText.trim()) || 0;
        const workProcessValue = parseFloat(workProcessColumns[index].querySelector('input')?.value || workProcessColumns[index].innerText.trim()) || 0;
        const finishedGoodsValue = parseFloat(finishedGoodsColumns[index].querySelector('input')?.value || finishedGoodsColumns[index].innerText.trim()) || 0;

        // Calculate Inventory
        const inventoryTotal = rawMaterialsValue + workProcessValue + finishedGoodsValue;

        // Update Inventory field
        const inventoryElement = document.getElementById(`inventory-${index + 1}`);
        if (inventoryElement) {
            inventoryElement.innerText = inventoryTotal;
        }
    });

    const cashShortTermColumns = document.querySelectorAll('.cash-cash-equivalents-and-short-term-column'); // Auto-calculated
const receivablesColumns = document.querySelectorAll('.receivables-column'); // Auto-calculated
const inventoryColumns = document.querySelectorAll('.inventory-column'); // Auto-calculated
const hedgingAssetsColumns = document.querySelectorAll('.hedging-assets-column'); // Input field
const otherCurrentAssetsColumns = document.querySelectorAll('.other-current-assets-column'); // Input field

cashShortTermColumns.forEach((cashShortTermCell, index) => {
    const cashShortTerm = parseFloat(cashShortTermCell.innerText.trim()) || 0;
    const receivables = parseFloat(receivablesColumns[index]?.innerText.trim()) || 0;
    const inventory = parseFloat(inventoryColumns[index]?.innerText.trim()) || 0;
    const hedgingAssets = parseFloat(hedgingAssetsColumns[index].querySelector('input')?.value || hedgingAssetsColumns[index]?.innerText.trim()) || 0;
    const otherCurrentAssets = parseFloat(otherCurrentAssetsColumns[index].querySelector('input')?.value || otherCurrentAssetsColumns[index]?.innerText.trim()) || 0;

    const currentAssetsTotal = cashShortTerm + receivables + inventory + hedgingAssets + otherCurrentAssets;

    // Update totals in the corresponding fields
    document.getElementById(`current-assets-${index + 1}`).innerText = currentAssetsTotal; // Using toFixed(2) to format the number to 2 decimal places
});


const landImprovementsColumns = document.querySelectorAll('.land_and_improvements-column');
const buildingsColumns = document.querySelectorAll('.buildings_and_improvements-column');
const machineryColumns = document.querySelectorAll('.machinery_furniture_equipment-column');
const otherPropertiesColumns = document.querySelectorAll('.other_properties-column');
const leasesColumns = document.querySelectorAll('.leases-column');

landImprovementsColumns.forEach((landCell, index) => {
    const land = parseFloat(landCell.querySelector('input')?.value || landCell.innerText.trim()) || 0;
    const buildings = parseFloat(buildingsColumns[index].querySelector('input')?.value || buildingsColumns[index].innerText.trim()) || 0;
    const machinery = parseFloat(machineryColumns[index].querySelector('input')?.value || machineryColumns[index].innerText.trim()) || 0;
    const otherProperties = parseFloat(otherPropertiesColumns[index].querySelector('input')?.value || otherPropertiesColumns[index].innerText.trim()) || 0;
    const leases = parseFloat(leasesColumns[index].querySelector('input')?.value || leasesColumns[index].innerText.trim()) || 0;
    console.log(land, buildings, machinery, otherProperties, leases)
    const grossPPE = land + buildings + machinery + otherProperties + leases;

    // Update the Gross PPE total in the corresponding field
    document.getElementById(`gross_ppe-${index + 1}`).innerText = grossPPE; // Using toFixed(2) to format the number to 2 decimal places
});

const grossPPEColumns = document.querySelectorAll('.gross_ppe-column');
const accumulatedDepreciationColumns = document.querySelectorAll('.accumulated_depreciation-column');

grossPPEColumns.forEach((grossPPECell, index) => {
    const grossPPE = parseFloat(grossPPECell.querySelector('input')?.value || grossPPECell.innerText.trim()) || 0;
    const accumulatedDepreciation = parseFloat(accumulatedDepreciationColumns[index].querySelector('input')?.value || accumulatedDepreciationColumns[index].innerText.trim()) || 0;

    const netPPE = grossPPE - accumulatedDepreciation;

    // Update the Net PPE in the corresponding field
    document.getElementById(`net_ppe-${index + 1}`).innerText = netPPE; // Using toFixed(2) to format the number to 2 decimal places
});

const goodwillColumns = document.querySelectorAll('.goodwill-column');
const otherIntangibleAssetsColumns = document.querySelectorAll('.other-intangible-assets-column');

goodwillColumns.forEach((goodwillCell, index) => {
    const goodwill = parseFloat(goodwillCell.querySelector('input')?.value || goodwillCell.innerText.trim()) || 0;
    const otherIntangibleAssets = parseFloat(otherIntangibleAssetsColumns[index].querySelector('input')?.value || otherIntangibleAssetsColumns[index].innerText.trim()) || 0;

    const totalIntangibleAssets = goodwill + otherIntangibleAssets;

    // Update the Goodwill and Other Intangible Assets total in the corresponding field
    document.getElementById(`goodwill_and_other_intangible_assets-${index + 1}`).innerText = totalIntangibleAssets; // Using toFixed(2) to format the number to 2 decimal places
});

const investmentsColumns = document.querySelectorAll('.long-term-equity-investment-column');

investmentsColumns.forEach((investmentCell, index) => {
    const longTermEquityInvestment = parseFloat(investmentCell.querySelector('input')?.value || investmentCell.innerText.trim()) || 0;

    // Update the Investments and Advances total in the corresponding field
    document.getElementById(`investments_and_advances-${index + 1}`).innerText = longTermEquityInvestment // Using toFixed(2) to format the number to 2 decimal places
});


const currentAssetsColumns = document.querySelectorAll('.current-assets-column'); // Auto-calculated
const totalNonCurrentAssetsColumns = document.querySelectorAll('.total_non_current_assets_column'); // Auto-calculated

currentAssetsColumns.forEach((currentAssetsCell, index) => {
    const currentAssets = parseFloat(currentAssetsCell.innerText.trim()) || 0;
    const totalNonCurrentAssets = parseFloat(totalNonCurrentAssetsColumns[index].innerText.trim()) || 0;

    const totalAssets = currentAssets + totalNonCurrentAssets;

    // Update totals in the corresponding fields
    //document.getElementById(`total_assets-${index + 1}`).innerText = totalAssets.toFixed(2); // Using toFixed(2) to format the number to 2 decimal places

    document.getElementById(`total_assets-${index + 1}`).innerText = 
    Number.isInteger(totalAssets) ? totalAssets : totalAssets.toFixed(2);

});


const netPPEColumns = document.querySelectorAll('.net_ppe_column');
const goodwillIntangibleColumns = document.querySelectorAll('.goodwill_and_other_intangible_assets_column');
const investmentsAdvancesColumns = document.querySelectorAll('.investments_and_advances_column');
const otherNonCurrentAssetsColumns = document.querySelectorAll('.other_non_current_assets_column');

netPPEColumns.forEach((netPPECell, index) => {
    const netPPE = parseFloat(netPPECell.innerText.trim()) || 0;
    const goodwillIntangible = parseFloat(goodwillIntangibleColumns[index].innerText.trim()) || 0;
    const investmentsAdvances = parseFloat(investmentsAdvancesColumns[index].innerText.trim()) || 0;
    const otherNonCurrentAssets = parseFloat(otherNonCurrentAssetsColumns[index].querySelector('input')?.value || otherNonCurrentAssetsColumns[index].innerText.trim()) || 0;

    const totalNonCurrentAssets = netPPE + goodwillIntangible + investmentsAdvances + otherNonCurrentAssets;

    // Update totals in the corresponding fields
    document.getElementById(`total_non_current_assets-${index + 1}`).innerText = totalNonCurrentAssets; // Using toFixed(2) to format the number to 2 decimal places
});

// const currentAssetsColumns = document.querySelectorAll('.current-assets-column');
// const totalNonCurrentAssetsColumns = document.querySelectorAll('.total_non_current_assets_column');

// currentAssetsColumns.forEach((currentAssetsCell, index) => {
//     const currentAssets = parseFloat(currentAssetsCell.querySelector('input')?.value.trim() || currentAssetsCell.innerText.trim()) || 0;
//     const totalNonCurrentAssets = parseFloat(totalNonCurrentAssetsColumns[index].querySelector('input')?.value.trim() || totalNonCurrentAssetsColumns[index].innerText.trim()) || 0;

//     const totalAssets = currentAssets + totalNonCurrentAssets;

//     // Update totals in the corresponding fields
//     document.getElementById(`total_assets-${index + 1}`).innerText = totalAssets.toFixed(2); // Using toFixed(2) to format the number to 2 decimal places
// });




    const currentDebtCells = document.querySelectorAll('.current-debt-column');
    const capitalLeaseCells = document.querySelectorAll('.capital-lease-column');

    currentDebtCells.forEach((debtCell, index) => {
        // Retrieve values from inputs or text content.
        const currentDebtInput = debtCell.querySelector('input');
        const currentDebt = parseFloat(currentDebtInput ? currentDebtInput.value : debtCell.innerText.trim()) || 0;

        const capitalLeaseInput = capitalLeaseCells[index].querySelector('input');
        const capitalLease = parseFloat(capitalLeaseInput ? capitalLeaseInput.value : capitalLeaseCells[index].innerText.trim()) || 0;

        // Compute the total for Current Debt and Capital Lease Obligation
        const totalDebtAndLease = currentDebt + capitalLease;
        const totalElementId = `current-debt-and-capital-lease-obligation-${index + 1}`;
        const totalElement = document.getElementById(totalElementId);

        if (totalElement) {
            totalElement.innerText = totalDebtAndLease;
            (`Updated Current Debt and Capital Lease Obligation for row ${index + 1} to ${totalDebtAndLease}`);
        } else {
           (`Current Debt and Capital Lease Obligation element for row ${index + 1} not found with ID ${totalElementId}.`);
        }
    });
    const deferredRevenueCells = document.querySelectorAll('.deferred-revenue-column');

deferredRevenueCells.forEach((revenueCell, index) => {
    // Retrieve the value from an input field or text content within the cell.
    const revenueInput = revenueCell.querySelector('input');
    const deferredRevenue = parseFloat(revenueInput ? revenueInput.value : revenueCell.innerText.trim()) || 0;

    // Find the element that should display the total Current Deferred Liabilities
    const totalElementId = `current-deferred-liabilities-${index + 1}`;
    const totalElement = document.getElementById(totalElementId);

    if (totalElement) {
        totalElement.innerText = deferredRevenue;
        (`Updated Current Deferred Liabilities for row ${index + 1} to ${deferredRevenue}`);
    } else {
       (`Current Deferred Liabilities element for row ${index + 1} not found with ID ${totalElementId}.`);
    }

});

const accountsPayableColumns = document.querySelectorAll('.accounts-payable-column');
    const incomeTaxPayableColumns = document.querySelectorAll('.income-tax-payable-column');

    accountsPayableColumns.forEach((accountsPayableCell, index) => {
        // Ensure that there is a corresponding entry in the income tax payable columns
        if (index >= incomeTaxPayableColumns.length) {
         
            return;
        }

        const incomeTaxPayableCell = incomeTaxPayableColumns[index];

        // Extract values, assuming they could be in inputs or just text
        const accountsPayableValue = parseFloat(accountsPayableCell.querySelector('input')?.value || accountsPayableCell.innerText.trim()) || 0;
        const incomeTaxPayableValue = parseFloat(incomeTaxPayableCell.querySelector('input')?.value || incomeTaxPayableCell.innerText.trim()) || 0;

        // Calculate the total for Payables and Accrued Expenses
        const totalPayablesAndAccruedExpenses = accountsPayableValue + incomeTaxPayableValue;

        // Find the element to update the total (make sure the HTML has this ID structure)
        const payablesAccruedExpensesElement = document.getElementById(`payables-and-accrued-expenses-${index + 1}`);
        if (payablesAccruedExpensesElement) {
            payablesAccruedExpensesElement.innerText = totalPayablesAndAccruedExpenses;
        } else {
           pass;
        }
    });

    const payablesAccruedExpensesColumns = document.querySelectorAll('.payables-accrued-column');
    const pensionRetirementPlansCurrentColumns = document.querySelectorAll('.pension-post-retirement-column');
    const debtLeaseColumns = document.querySelectorAll('.current-debt-and-capital-lease-obligation-column');
    const deferredLiabilitiesColumns = document.querySelectorAll('.deferred-liabilities-column');
    const otherCurrentLiabilitiesColumns = document.querySelectorAll('.other-current-liabilities-column');

    // Loop through one of the columns to determine the number of rows
    payablesAccruedExpensesColumns.forEach((cell, index) => {
        const payablesAccruedExpenses = parseFloat(cell.innerText.trim()) || 0;
        const input = pensionRetirementPlansCurrentColumns[index].querySelector('input');
        const pensionRetirementPlansCurrent = parseFloat(input ? input.value : pensionRetirementPlansCurrentColumns[index].innerText.trim()) || 0;
        const debtLease = parseFloat(debtLeaseColumns[index].innerText.trim()) || 0;
        const deferredLiabilities = parseFloat(deferredLiabilitiesColumns[index].innerText.trim()) || 0;
        const otherCurrentLiabilities = parseFloat(otherCurrentLiabilitiesColumns[index].querySelector('input')?.value || otherCurrentLiabilitiesColumns[index].innerText.trim()) || 0;
        console.log(pensionRetirementPlansCurrent)
        // Calculate total Current Liabilities
        const totalCurrentLiabilities = payablesAccruedExpenses + pensionRetirementPlansCurrent + debtLease + deferredLiabilities + otherCurrentLiabilities;

        // Find the element where this total should be displayed
        const grossppe = document.getElementById(`current-liabilities-${index + 1}`);
        if (grossppe) {
            grossppe.innerText = totalCurrentLiabilities;
        } else {
            pass;
        }
    });

    const longTermDebtColumns = document.querySelectorAll('.long-term-debt-column input');
    const capitalLeaseColumns = document.querySelectorAll('.long-term-capital-lease-column input');

    longTermDebtColumns.forEach((input, index) => {
        const longTermDebt = parseFloat(input.value.trim()) || 0;
        const capitalLeaseInput = capitalLeaseColumns[index];
        const capitalLease = parseFloat(capitalLeaseInput.value.trim()) || 0;

        const totalLongTermDebtAndLease = longTermDebt + capitalLease;

        // Ensure the ID is set correctly in the total calculation element
        const totalElement = document.getElementById(`long-term-debt-and-capital-lease-obligation-${index + 1}`);
        if (totalElement) {
            totalElement.innerText = totalLongTermDebtAndLease;
        } else {
            (`Total Long Term Debt and Capital Lease Obligation element not found for column ${index + 1}`);
        }
    });
    const deferredTaxColumns = document.querySelectorAll('.non-current-deferred-taxes-column input');
    const deferredRevenueColumns = document.querySelectorAll('.non-current-deferred-revenue-column input');

    deferredTaxColumns.forEach((input, index) => {
        const deferredTax = parseFloat(input.value.trim()) || 0;
        const deferredRevenueInput = deferredRevenueColumns[index];
        const deferredRevenue = parseFloat(deferredRevenueInput.value.trim()) || 0;

        const totalDeferred = deferredTax + deferredRevenue;

        // Ensure the ID is set correctly in the total calculation element
        const totalElement = document.getElementById(`non-current-deferred-liabilities-${index + 1}`);
        if (totalElement) {
            totalElement.innerText = totalDeferred;
        } else {
            (`Total Deferred element not found for column ${index + 1}`);
        }
    });
    const rows = document.querySelectorAll('.liability-row'); // Adjust class to match your rows if needed

    rows.forEach(row => {
    // You may need to adjust the query selector to match your actual input fields or text content
    const longTermDebtAndLease = parseFloat(row.querySelector('.long-term-debt-lease-input').value) || 0;
    const deferredLiabilities = parseFloat(row.querySelector('.deferred-liabilities-input').value) || 0;
    const tradePayables = parseFloat(row.querySelector('.trade-payables-input').value) || 0;
    const otherLiabilities = parseFloat(row.querySelector('.other-liabilities-input').value) || 0;

    const totalLiabilities = longTermDebtAndLease + deferredLiabilities + tradePayables + otherLiabilities;

    const totalElement = row.querySelector('.total-liabilities-output'); // Adjust ID or class to match your total field
    if (totalElement) {
        //totalElement.innerText = totalLiabilities.toFixed(2);
        totalElement.innerText = 
    Number.isInteger(totalLiabilities) ? totalLiabilities : totalLiabilities.toFixed(2);

    } else {
        console.error('Total liabilities element not found');
    }
});
const nonCurrentLiabilitiesColumns = document.querySelectorAll('.other-non-current-liabilities-column input');
    const tradeOtherPayablesColumns = document.querySelectorAll('.trade-other-payables-column input');

    // Loop through each of the input columns by index
    nonCurrentLiabilitiesColumns.forEach((input, index) => {
        const nonCurrentLiabilities = parseFloat(input.value.trim()) || 0;
        const tradeOtherPayables = parseFloat(tradeOtherPayablesColumns[index].value.trim()) || 0;

        // Fetch the auto-calculated values from other columns
        const longTermDebtLease = parseFloat(document.querySelector(`#long-term-debt-and-capital-lease-obligation-${index + 1}`).innerText.trim()) || 0;
        const otherNonCurrentLiabilities = parseFloat(document.querySelector(`#other-non-current-liabilities-${index + 1}`).innerText.trim()) || 0;

        // Calculate the total for this index
        const total = longTermDebtLease + nonCurrentLiabilities + tradeOtherPayables + otherNonCurrentLiabilities;

        // Locate the total element by constructing its ID based on index + 1
        const totalElement = document.getElementById(`total-non-current-liabilities-net-minority-interest-${index + 1}`);
        if (totalElement) {
           // totalElement.innerText = total.toFixed(2); // Update the text with the calculated total, formatted to 2 decimal places
            totalElement.innerText = 
    Number.isInteger(total) ? total : total.toFixed(2);

        } else {
            console.error(`Total element not found for index ${index + 1}`);
        }
    });
    const commonStockInputs = document.querySelectorAll('.common-stock-column input'); // Ensure this class matches your actual HTML

commonStockInputs.forEach((input, index) => {
    const commonStock = parseFloat(input.value.trim()) || 0;

    // Assuming the Capital Stock is displayed directly and needs to be updated
    const capitalStockElement = document.getElementById(`capital-stock-${index + 1}`);
    if (capitalStockElement) {
        //capitalStockElement.innerText = commonStock.toFixed(2); // or any other calculation as required
        capitalStockElement.innerText = 
    Number.isInteger(commonStock) ? commonStock : commonStock.toFixed(2);

    } else {
        console.error(`Capital Stock element not found for index ${index + 1}`);
    }
});
const gainsLossesInputs = document.querySelectorAll('.gains-losses-column input');
    const otherEquityAdjustmentsInputs = document.querySelectorAll('.other-equity-adjustments-column input');

    gainsLossesInputs.forEach((input, index) => {
        const gainsLosses = parseFloat(input.value.trim()) || 0;
        const otherEquityAdjustments = parseFloat(otherEquityAdjustmentsInputs[index].value.trim()) || 0;

        // Fetching auto-calculated values directly from their respective elements
        const capitalStock = parseFloat(document.getElementById(`capital-stock-${index + 1}`).innerText.trim()) || 0;
        const retainedEarnings = parseFloat(document.getElementById(`retained-earnings-${index + 1}`).innerText.trim()) || 0;

        // Calculate the total for this index
        const totalStockholdersEquity = capitalStock + retainedEarnings + gainsLosses + otherEquityAdjustments;

        // Locate the total element by constructing its ID based on index + 1
        const totalstock = document.getElementById(`stockholders-equity-${index + 1}`);
        if (totalstock) {
            //totalstock.innerText = totalStockholdersEquity.toFixed(2); // Update the text with the calculated total, formatted to 2 decimal places
            totalstock.innerText = 
    Number.isInteger(totalStockholdersEquity) ? totalStockholdersEquity : totalStockholdersEquity.toFixed(2);


        } else {
            console.error(`Stockholders' Equity element not found for index ${index + 1}`);
        }
    });
    const stockholdersEquityElements = document.querySelectorAll('.stockholders-equity-column'); // Ensure this class matches your actual HTML

    stockholdersEquityElements.forEach((element, index) => {
    const stockholdersEquity = parseFloat(element.innerText.trim()) || 0;

    // Assuming the Total Equity Gross Minority Interest is displayed directly and needs to be updated
    const totalEquityGrossMinorityInterestElement = document.getElementById(`total-equity-gross-minority-interest-${index + 1}`);
    if (totalEquityGrossMinorityInterestElement) {
        //totalEquityGrossMinorityInterestElement.innerText = stockholdersEquity.toFixed(2); // You can modify this calculation if needed

        totalEquityGrossMinorityInterestElement.innerText = 
    Number.isInteger(stockholdersEquity) ? stockholdersEquity : stockholdersEquity.toFixed(2);

    } else {
        console.error(`Total Equity Gross Minority Interest element not found for index ${index + 1}`);
    }
});

    }
    document.querySelectorAll('.long_term_equity_investment_column input').forEach(input => {
input.addEventListener('input', calculatetotal);  // Calculate on input events
});
document.querySelectorAll('.goodwill_column input, .other_intangible_assets_column input').forEach(input => {
    input.addEventListener('input', calculatetotal);  // Calculate on input events
});


document.querySelectorAll(' .accumulated_depreciation_column input').forEach(input => {
    input.addEventListener('input', calculatetotal);  // Calculate Net PPE on input events
});
document.querySelectorAll('.other_non_current_assets_column input').forEach(input => {
    input.addEventListener('input', calculatetotal);
});
document.querySelectorAll('.accounts_payable_column input, .income_tax_payable_column input').forEach(input => {
    input.addEventListener('input', calculatetotal);  // Calculate on input events
});
document.querySelectorAll('.current-debt-column input, .capital-lease-column input').forEach(input => {
    input.addEventListener('input', calculatetotal);  // Calculate on input events
});

document.querySelectorAll('.deferred-revenue-column input').forEach(input => {
    input.addEventListener('input', calculatetotal);  // Calculate on input events
});

document.querySelectorAll('.pension-post-retirement-column input, .other-current-liabilities-column input').forEach(input => {
    input.addEventListener('input', calculatetotal);  // Calculate on input events
});

document.addEventListener('DOMContentLoaded', function () {
    // Initially filter the table to show only monthly values
    filterTable('monthly');

    // Add event listeners to the buttons
    document.querySelector('.btn-group').addEventListener('click', function (event) {
        const target = event.target;
        if (target.tagName === 'BUTTON') {
            const period = target.textContent.trim().toLowerCase();
            filterTable(period);
        }
    });
});

function filterTable(period) {
    const headers = document.querySelectorAll('th .period-type');
    const rows = document.querySelectorAll('tbody tr');

    headers.forEach((header, index) => {
        const periodType = header.textContent.trim().toLowerCase();
        if (periodType === period) {
            showColumn(index + 1);  // Show the column corresponding to the period
        } else {
            hideColumn(index + 1);  // Hide the column corresponding to the period
        }
    });

    showColumn(0);  // Ensure the first column (Breakdown) is always shown
}

function showColumn(index) {
    // Show the header
    document.querySelectorAll('th')[index].style.display = ''; 

    // Show all cells in this column
    const rows = document.querySelectorAll('tbody tr');
    rows.forEach(row => {
        row.querySelectorAll('td')[index].style.display = ''; 
    });
}

function hideColumn(index) {
    // Hide the header
    document.querySelectorAll('th')[index].style.display = 'none'; 

    // Hide all cells in this column
    const rows = document.querySelectorAll('tbody tr');
    rows.forEach(row => {
        row.querySelectorAll('td')[index].style.display = 'none';
    });
}

</script>
{% endblock content %}